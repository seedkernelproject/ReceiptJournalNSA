"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var core_1 = require("@angular/core");
var forms_1 = require("@angular/forms");
var receipt_service_1 = require("~/services/receipt.service");
var router_1 = require("@angular/router");
var NewReceiptComponent = /** @class */ (function () {
    function NewReceiptComponent(formBuilder, receiptService, changeDetectorRef, baseURL, router) {
        this.formBuilder = formBuilder;
        this.receiptService = receiptService;
        this.changeDetectorRef = changeDetectorRef;
        this.baseURL = baseURL;
        this.router = router;
        this.totalcost = 0;
        this.profit = 0;
        this.newreceipt = this.formBuilder.group({
            inputdate: '',
            receiptdate: '',
            clientname: ['', forms_1.Validators.required],
            origin: ['', forms_1.Validators.required],
            destination: ['', forms_1.Validators.required],
            totalprice: ['', forms_1.Validators.required],
            drivername: ['', forms_1.Validators.required],
            platenumber: ['', forms_1.Validators.required],
            drivercost: ['', forms_1.Validators.required],
            othercost: ['', forms_1.Validators.required],
            totalcost: 0,
            profit: 0,
            additionalremarks: '',
            status: false,
            paiddate: '9999-12-31',
        });
    }
    NewReceiptComponent.prototype.ngOnInit = function () {
    };
    NewReceiptComponent.prototype.onTextFieldChange = function (args) {
        var TextField = args.object;
        var a = TextField.id;
        this.newreceipt.patchValue({ a: TextField.text });
        if (TextField.id == "totalprice") {
            this.profit = parseFloat(TextField.text) - parseFloat(this.newreceipt.value.drivercost) - parseFloat(this.newreceipt.value.othercost);
            this.newreceipt.patchValue({ profit: this.profit });
        }
        if (TextField.id == "drivercost") {
            this.totalcost = parseFloat(TextField.text) + parseFloat(this.newreceipt.value.othercost);
            this.profit = parseFloat(this.newreceipt.value.totalprice) - parseFloat(TextField.text) - parseFloat(this.newreceipt.value.othercost);
            this.newreceipt.patchValue({ totalcost: this.profit });
            this.newreceipt.patchValue({ profit: this.profit });
        }
        if (TextField.id == "othercost") {
            this.totalcost = parseFloat(this.newreceipt.value.drivercost) + parseFloat(TextField.text);
            this.profit = parseFloat(this.newreceipt.value.totalprice) - parseFloat(this.newreceipt.value.drivercost) - parseFloat(TextField.text);
            this.newreceipt.patchValue({ totalcost: this.profit });
            this.newreceipt.patchValue({ profit: this.profit });
        }
    };
    NewReceiptComponent.prototype.onDatePickerSelect = function (args) {
        var DatePicker = args.object;
        console.log(DatePicker._getValue);
    };
    NewReceiptComponent.prototype.onSubmit = function () {
        var receiptdate = this.datepicker.nativeElement;
        var date = "";
        if (receiptdate.day < 10) {
            date = "0" + receiptdate.day;
        }
        else {
            date = "" + receiptdate.day;
        }
        this.newreceipt.patchValue({ receiptdate: receiptdate.year + "-" + receiptdate.month + "-" + date });
        console.log(JSON.stringify(this.newreceipt.value));
        this.receiptService.createReceipt(this.newreceipt.value)
            .subscribe(function (res) {
            console.log(res);
        }, function (errmess) {
            console.log(errmess);
        });
        this.router.navigate(['cashflow']);
    };
    NewReceiptComponent.prototype.numberWithCommas = function (x) {
        var parts = x.toString().split(".");
        parts[0] = parts[0].replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        return parts.join(".");
    };
    __decorate([
        core_1.ViewChild("datepicker"),
        __metadata("design:type", core_1.ElementRef)
    ], NewReceiptComponent.prototype, "datepicker", void 0);
    NewReceiptComponent = __decorate([
        core_1.Component({
            selector: 'app-menu',
            moduleId: module.id,
            templateUrl: './newreceipt.component.html',
            styleUrls: ['./newreceipt.component.css']
        }),
        __param(3, core_1.Inject('baseURL')),
        __metadata("design:paramtypes", [forms_1.FormBuilder, receipt_service_1.ReceiptService,
            core_1.ChangeDetectorRef, Object, router_1.Router])
    ], NewReceiptComponent);
    return NewReceiptComponent;
}());
exports.NewReceiptComponent = NewReceiptComponent;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmV3cmVjZWlwdC5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJuZXdyZWNlaXB0LmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLHNDQUFtRztBQUNuRyx3Q0FBb0U7QUFJcEUsOERBQTREO0FBQzVELDBDQUF3RDtBQVN4RDtJQU1FLDZCQUFvQixXQUF3QixFQUFTLGNBQThCLEVBQ3pFLGlCQUFtQyxFQUNoQixPQUFPLEVBQzFCLE1BQWE7UUFISCxnQkFBVyxHQUFYLFdBQVcsQ0FBYTtRQUFTLG1CQUFjLEdBQWQsY0FBYyxDQUFnQjtRQUN6RSxzQkFBaUIsR0FBakIsaUJBQWlCLENBQWtCO1FBQ2hCLFlBQU8sR0FBUCxPQUFPLENBQUE7UUFDMUIsV0FBTSxHQUFOLE1BQU0sQ0FBTztRQVB2QixjQUFTLEdBQVMsQ0FBQyxDQUFDO1FBQ3BCLFdBQU0sR0FBUyxDQUFDLENBQUM7UUFPZixJQUFJLENBQUMsVUFBVSxHQUFHLElBQUksQ0FBQyxXQUFXLENBQUMsS0FBSyxDQUFDO1lBQ3ZDLFNBQVMsRUFBVSxFQUFFO1lBQ3JCLFdBQVcsRUFBUSxFQUFFO1lBQ3JCLFVBQVUsRUFBUyxDQUFDLEVBQUUsRUFBRSxrQkFBVSxDQUFDLFFBQVEsQ0FBQztZQUM1QyxNQUFNLEVBQWEsQ0FBQyxFQUFFLEVBQUUsa0JBQVUsQ0FBQyxRQUFRLENBQUM7WUFDNUMsV0FBVyxFQUFRLENBQUMsRUFBRSxFQUFFLGtCQUFVLENBQUMsUUFBUSxDQUFDO1lBQzVDLFVBQVUsRUFBUyxDQUFDLEVBQUUsRUFBRSxrQkFBVSxDQUFDLFFBQVEsQ0FBQztZQUM1QyxVQUFVLEVBQVMsQ0FBQyxFQUFFLEVBQUUsa0JBQVUsQ0FBQyxRQUFRLENBQUM7WUFDNUMsV0FBVyxFQUFRLENBQUMsRUFBRSxFQUFFLGtCQUFVLENBQUMsUUFBUSxDQUFDO1lBQzVDLFVBQVUsRUFBUyxDQUFDLEVBQUUsRUFBRSxrQkFBVSxDQUFDLFFBQVEsQ0FBQztZQUM1QyxTQUFTLEVBQVUsQ0FBQyxFQUFFLEVBQUUsa0JBQVUsQ0FBQyxRQUFRLENBQUM7WUFDNUMsU0FBUyxFQUFVLENBQUM7WUFDcEIsTUFBTSxFQUFhLENBQUM7WUFDcEIsaUJBQWlCLEVBQUUsRUFBRTtZQUNyQixNQUFNLEVBQWEsS0FBSztZQUN4QixRQUFRLEVBQVcsWUFBWTtTQUNoQyxDQUFDLENBQUM7SUFDTCxDQUFDO0lBRUQsc0NBQVEsR0FBUjtJQUNBLENBQUM7SUFFRCwrQ0FBaUIsR0FBakIsVUFBa0IsSUFBSTtRQUNwQixJQUFJLFNBQVMsR0FBYyxJQUFJLENBQUMsTUFBTSxDQUFDO1FBQ3ZDLElBQUksQ0FBQyxHQUFHLFNBQVMsQ0FBQyxFQUFFLENBQUM7UUFDckIsSUFBSSxDQUFDLFVBQVUsQ0FBQyxVQUFVLENBQUMsRUFBQyxDQUFDLEVBQUcsU0FBUyxDQUFDLElBQUksRUFBQyxDQUFDLENBQUM7UUFDakQsRUFBRSxDQUFBLENBQUMsU0FBUyxDQUFDLEVBQUUsSUFBRSxZQUFZLENBQUMsQ0FBQSxDQUFDO1lBQzdCLElBQUksQ0FBQyxNQUFNLEdBQUUsVUFBVSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsR0FBRyxVQUFVLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxLQUFLLENBQUMsVUFBVSxDQUFDLEdBQUcsVUFBVSxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsS0FBSyxDQUFDLFNBQVMsQ0FBQyxDQUFDO1lBQ3JJLElBQUksQ0FBQyxVQUFVLENBQUMsVUFBVSxDQUFDLEVBQUMsTUFBTSxFQUFHLElBQUksQ0FBQyxNQUFNLEVBQUMsQ0FBQyxDQUFDO1FBQ3JELENBQUM7UUFDRCxFQUFFLENBQUEsQ0FBQyxTQUFTLENBQUMsRUFBRSxJQUFFLFlBQVksQ0FBQyxDQUFBLENBQUM7WUFDN0IsSUFBSSxDQUFDLFNBQVMsR0FBRyxVQUFVLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxHQUFHLFVBQVUsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLEtBQUssQ0FBQyxTQUFTLENBQUMsQ0FBQztZQUMxRixJQUFJLENBQUMsTUFBTSxHQUFFLFVBQVUsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLEtBQUssQ0FBQyxVQUFVLENBQUMsR0FBRyxVQUFVLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxHQUFHLFVBQVUsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLEtBQUssQ0FBQyxTQUFTLENBQUMsQ0FBQztZQUNySSxJQUFJLENBQUMsVUFBVSxDQUFDLFVBQVUsQ0FBQyxFQUFDLFNBQVMsRUFBRyxJQUFJLENBQUMsTUFBTSxFQUFDLENBQUMsQ0FBQztZQUN0RCxJQUFJLENBQUMsVUFBVSxDQUFDLFVBQVUsQ0FBQyxFQUFDLE1BQU0sRUFBRyxJQUFJLENBQUMsTUFBTSxFQUFDLENBQUMsQ0FBQztRQUNyRCxDQUFDO1FBQ0QsRUFBRSxDQUFBLENBQUMsU0FBUyxDQUFDLEVBQUUsSUFBRSxXQUFXLENBQUMsQ0FBQSxDQUFDO1lBQzVCLElBQUksQ0FBQyxTQUFTLEdBQUcsVUFBVSxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsS0FBSyxDQUFDLFVBQVUsQ0FBQyxHQUFHLFVBQVUsQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDM0YsSUFBSSxDQUFDLE1BQU0sR0FBRSxVQUFVLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxLQUFLLENBQUMsVUFBVSxDQUFDLEdBQUcsVUFBVSxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsS0FBSyxDQUFDLFVBQVUsQ0FBQyxHQUFHLFVBQVUsQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDdEksSUFBSSxDQUFDLFVBQVUsQ0FBQyxVQUFVLENBQUMsRUFBQyxTQUFTLEVBQUcsSUFBSSxDQUFDLE1BQU0sRUFBQyxDQUFDLENBQUM7WUFDdEQsSUFBSSxDQUFDLFVBQVUsQ0FBQyxVQUFVLENBQUMsRUFBQyxNQUFNLEVBQUcsSUFBSSxDQUFDLE1BQU0sRUFBQyxDQUFDLENBQUM7UUFDckQsQ0FBQztJQUFFLENBQUM7SUFFTixnREFBa0IsR0FBbEIsVUFBbUIsSUFBSTtRQUNyQixJQUFJLFVBQVUsR0FBZSxJQUFJLENBQUMsTUFBTSxDQUFDO1FBQ3pDLE9BQU8sQ0FBQyxHQUFHLENBQUMsVUFBVSxDQUFDLFNBQVMsQ0FBQyxDQUFBO0lBQ25DLENBQUM7SUFFRCxzQ0FBUSxHQUFSO1FBQ0UsSUFBSSxXQUFXLEdBQWUsSUFBSSxDQUFDLFVBQVUsQ0FBQyxhQUFhLENBQUM7UUFDNUQsSUFBSSxJQUFJLEdBQUcsRUFBRSxDQUFDO1FBQ2QsRUFBRSxDQUFDLENBQUMsV0FBVyxDQUFDLEdBQUcsR0FBQyxFQUFFLENBQUMsQ0FBQSxDQUFDO1lBQ3RCLElBQUksR0FBRyxHQUFHLEdBQUMsV0FBVyxDQUFDLEdBQUcsQ0FBQTtRQUM1QixDQUFDO1FBQUEsSUFBSSxDQUFBLENBQUM7WUFDSixJQUFJLEdBQUcsRUFBRSxHQUFDLFdBQVcsQ0FBQyxHQUFHLENBQUE7UUFDM0IsQ0FBQztRQUNELElBQUksQ0FBQyxVQUFVLENBQUMsVUFBVSxDQUFDLEVBQUMsV0FBVyxFQUFHLFdBQVcsQ0FBQyxJQUFJLEdBQUMsR0FBRyxHQUFDLFdBQVcsQ0FBQyxLQUFLLEdBQUMsR0FBRyxHQUFDLElBQUksRUFBQyxDQUFDLENBQUM7UUFDNUYsT0FBTyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQTtRQUNsRCxJQUFJLENBQUMsY0FBYyxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLEtBQUssQ0FBQzthQUNyRCxTQUFTLENBQUMsVUFBQSxHQUFHO1lBQ1osT0FBTyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUNuQixDQUFDLEVBQ0MsVUFBQSxPQUFPO1lBQ0wsT0FBTyxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsQ0FBQTtRQUN4QixDQUFDLENBQUMsQ0FBQztRQUNILElBQUksQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQTtJQUN0QyxDQUFDO0lBRUQsOENBQWdCLEdBQWhCLFVBQWlCLENBQUM7UUFDaEIsSUFBSSxLQUFLLEdBQUcsQ0FBQyxDQUFDLFFBQVEsRUFBRSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUNwQyxLQUFLLENBQUMsQ0FBQyxDQUFDLEdBQUcsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyx1QkFBdUIsRUFBRSxHQUFHLENBQUMsQ0FBQztRQUMxRCxNQUFNLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQztJQUMzQixDQUFDO0lBOUUwQjtRQUF4QixnQkFBUyxDQUFDLFlBQVksQ0FBQztrQ0FBYSxpQkFBVTsyREFBQTtJQUpwQyxtQkFBbUI7UUFOL0IsZ0JBQVMsQ0FBQztZQUNULFFBQVEsRUFBRSxVQUFVO1lBQ3BCLFFBQVEsRUFBRSxNQUFNLENBQUMsRUFBRTtZQUNuQixXQUFXLEVBQUUsNkJBQTZCO1lBQzFDLFNBQVMsRUFBRSxDQUFDLDRCQUE0QixDQUFDO1NBQzFDLENBQUM7UUFTRyxXQUFBLGFBQU0sQ0FBQyxTQUFTLENBQUMsQ0FBQTt5Q0FGYSxtQkFBVyxFQUF5QixnQ0FBYztZQUN2RCx3QkFBaUIsVUFFNUIsZUFBTTtPQVRaLG1CQUFtQixDQW1GN0I7SUFBRCwwQkFBQztDQUFBLEFBbkZILElBbUZHO0FBbkZVLGtEQUFtQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgT25Jbml0LCBJbmplY3QsQ2hhbmdlRGV0ZWN0b3JSZWYsIEVsZW1lbnRSZWYsIFZpZXdDaGlsZCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgVmFsaWRhdG9ycywgRm9ybUJ1aWxkZXIsIEZvcm1Hcm91cCB9IGZyb20gJ0Bhbmd1bGFyL2Zvcm1zJztcbmltcG9ydCB7IFRleHRGaWVsZCB9IGZyb20gJ3VpL3RleHQtZmllbGQnO1xuaW1wb3J0IHsgVGV4dFZpZXcgfSBmcm9tICd1aS90ZXh0LXZpZXcnO1xuaW1wb3J0IHsgRGF0ZVBpY2tlciB9IGZyb20gXCJ0bnMtY29yZS1tb2R1bGVzL3VpL2RhdGUtcGlja2VyXCI7XG5pbXBvcnQgeyBSZWNlaXB0U2VydmljZSB9IGZyb20gJ34vc2VydmljZXMvcmVjZWlwdC5zZXJ2aWNlJztcbmltcG9ydCB7IE5hdmlnYXRpb25FbmQsIFJvdXRlciB9IGZyb20gXCJAYW5ndWxhci9yb3V0ZXJcIjtcblxuXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdhcHAtbWVudScsXG4gIG1vZHVsZUlkOiBtb2R1bGUuaWQsXG4gIHRlbXBsYXRlVXJsOiAnLi9uZXdyZWNlaXB0LmNvbXBvbmVudC5odG1sJyxcbiAgc3R5bGVVcmxzOiBbJy4vbmV3cmVjZWlwdC5jb21wb25lbnQuY3NzJ11cbn0pXG5leHBvcnQgY2xhc3MgTmV3UmVjZWlwdENvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCB7XG4gIG5ld3JlY2VpcHQ6IEZvcm1Hcm91cDtcbiAgdG90YWxjb3N0OiBudW1iZXI9MDtcbiAgcHJvZml0OiBudW1iZXI9MDtcbiAgQFZpZXdDaGlsZChcImRhdGVwaWNrZXJcIikgZGF0ZXBpY2tlcjogRWxlbWVudFJlZlxuXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgZm9ybUJ1aWxkZXI6IEZvcm1CdWlsZGVyLHByaXZhdGUgcmVjZWlwdFNlcnZpY2U6IFJlY2VpcHRTZXJ2aWNlLFxuICAgIHByaXZhdGUgY2hhbmdlRGV0ZWN0b3JSZWY6Q2hhbmdlRGV0ZWN0b3JSZWYsXG4gICAgQEluamVjdCgnYmFzZVVSTCcpIHByaXZhdGUgYmFzZVVSTCxcbiAgICBwcml2YXRlIHJvdXRlcjpSb3V0ZXIpIHsgIFxuICAgIHRoaXMubmV3cmVjZWlwdCA9IHRoaXMuZm9ybUJ1aWxkZXIuZ3JvdXAoe1xuICAgICAgaW5wdXRkYXRlOiAgICAgICAgICcnLFxuICAgICAgcmVjZWlwdGRhdGU6ICAgICAgICcnLFxuICAgICAgY2xpZW50bmFtZTogICAgICAgIFsnJywgVmFsaWRhdG9ycy5yZXF1aXJlZF0sXG4gICAgICBvcmlnaW46ICAgICAgICAgICAgWycnLCBWYWxpZGF0b3JzLnJlcXVpcmVkXSxcbiAgICAgIGRlc3RpbmF0aW9uOiAgICAgICBbJycsIFZhbGlkYXRvcnMucmVxdWlyZWRdLFxuICAgICAgdG90YWxwcmljZTogICAgICAgIFsnJywgVmFsaWRhdG9ycy5yZXF1aXJlZF0sXG4gICAgICBkcml2ZXJuYW1lOiAgICAgICAgWycnLCBWYWxpZGF0b3JzLnJlcXVpcmVkXSxcbiAgICAgIHBsYXRlbnVtYmVyOiAgICAgICBbJycsIFZhbGlkYXRvcnMucmVxdWlyZWRdLFxuICAgICAgZHJpdmVyY29zdDogICAgICAgIFsnJywgVmFsaWRhdG9ycy5yZXF1aXJlZF0sXG4gICAgICBvdGhlcmNvc3Q6ICAgICAgICAgWycnLCBWYWxpZGF0b3JzLnJlcXVpcmVkXSxcbiAgICAgIHRvdGFsY29zdDogICAgICAgICAwLFxuICAgICAgcHJvZml0OiAgICAgICAgICAgIDAsXG4gICAgICBhZGRpdGlvbmFscmVtYXJrczogJycsXG4gICAgICBzdGF0dXM6ICAgICAgICAgICAgZmFsc2UsXG4gICAgICBwYWlkZGF0ZTogICAgICAgICAgJzk5OTktMTItMzEnLFxuICAgIH0pOyAgXG4gIH1cblxuICBuZ09uSW5pdCgpIHtcbiAgfVxuXG4gIG9uVGV4dEZpZWxkQ2hhbmdlKGFyZ3Mpe1xuICAgIGxldCBUZXh0RmllbGQgPSA8VGV4dEZpZWxkPmFyZ3Mub2JqZWN0O1xuICAgIHZhciBhID0gVGV4dEZpZWxkLmlkO1xuICAgIHRoaXMubmV3cmVjZWlwdC5wYXRjaFZhbHVlKHthIDogVGV4dEZpZWxkLnRleHR9KTtcbiAgICBpZihUZXh0RmllbGQuaWQ9PVwidG90YWxwcmljZVwiKXtcbiAgICAgIHRoaXMucHJvZml0PSBwYXJzZUZsb2F0KFRleHRGaWVsZC50ZXh0KSAtIHBhcnNlRmxvYXQodGhpcy5uZXdyZWNlaXB0LnZhbHVlLmRyaXZlcmNvc3QpIC0gcGFyc2VGbG9hdCh0aGlzLm5ld3JlY2VpcHQudmFsdWUub3RoZXJjb3N0KTtcbiAgICAgIHRoaXMubmV3cmVjZWlwdC5wYXRjaFZhbHVlKHtwcm9maXQgOiB0aGlzLnByb2ZpdH0pO1xuICAgIH1cbiAgICBpZihUZXh0RmllbGQuaWQ9PVwiZHJpdmVyY29zdFwiKXtcbiAgICAgIHRoaXMudG90YWxjb3N0ID0gcGFyc2VGbG9hdChUZXh0RmllbGQudGV4dCkgKyBwYXJzZUZsb2F0KHRoaXMubmV3cmVjZWlwdC52YWx1ZS5vdGhlcmNvc3QpO1xuICAgICAgdGhpcy5wcm9maXQ9IHBhcnNlRmxvYXQodGhpcy5uZXdyZWNlaXB0LnZhbHVlLnRvdGFscHJpY2UpIC0gcGFyc2VGbG9hdChUZXh0RmllbGQudGV4dCkgLSBwYXJzZUZsb2F0KHRoaXMubmV3cmVjZWlwdC52YWx1ZS5vdGhlcmNvc3QpO1xuICAgICAgdGhpcy5uZXdyZWNlaXB0LnBhdGNoVmFsdWUoe3RvdGFsY29zdCA6IHRoaXMucHJvZml0fSk7XG4gICAgICB0aGlzLm5ld3JlY2VpcHQucGF0Y2hWYWx1ZSh7cHJvZml0IDogdGhpcy5wcm9maXR9KTtcbiAgICB9XG4gICAgaWYoVGV4dEZpZWxkLmlkPT1cIm90aGVyY29zdFwiKXtcbiAgICAgIHRoaXMudG90YWxjb3N0ID0gcGFyc2VGbG9hdCh0aGlzLm5ld3JlY2VpcHQudmFsdWUuZHJpdmVyY29zdCkgKyBwYXJzZUZsb2F0KFRleHRGaWVsZC50ZXh0KTtcbiAgICAgIHRoaXMucHJvZml0PSBwYXJzZUZsb2F0KHRoaXMubmV3cmVjZWlwdC52YWx1ZS50b3RhbHByaWNlKSAtIHBhcnNlRmxvYXQodGhpcy5uZXdyZWNlaXB0LnZhbHVlLmRyaXZlcmNvc3QpIC0gcGFyc2VGbG9hdChUZXh0RmllbGQudGV4dCk7XG4gICAgICB0aGlzLm5ld3JlY2VpcHQucGF0Y2hWYWx1ZSh7dG90YWxjb3N0IDogdGhpcy5wcm9maXR9KTtcbiAgICAgIHRoaXMubmV3cmVjZWlwdC5wYXRjaFZhbHVlKHtwcm9maXQgOiB0aGlzLnByb2ZpdH0pO1xuICAgIH0gIH1cblxuICBvbkRhdGVQaWNrZXJTZWxlY3QoYXJncyl7XG4gICAgbGV0IERhdGVQaWNrZXIgPSA8RGF0ZVBpY2tlcj5hcmdzLm9iamVjdDtcbiAgICBjb25zb2xlLmxvZyhEYXRlUGlja2VyLl9nZXRWYWx1ZSlcbiAgfVxuICBcbiAgb25TdWJtaXQoKSB7XG4gICAgbGV0IHJlY2VpcHRkYXRlID0gPERhdGVQaWNrZXI+dGhpcy5kYXRlcGlja2VyLm5hdGl2ZUVsZW1lbnQ7XG4gICAgdmFyIGRhdGUgPSBcIlwiO1xuICAgIGlmIChyZWNlaXB0ZGF0ZS5kYXk8MTApe1xuICAgICAgZGF0ZSA9IFwiMFwiK3JlY2VpcHRkYXRlLmRheVxuICAgIH1lbHNle1xuICAgICAgZGF0ZSA9IFwiXCIrcmVjZWlwdGRhdGUuZGF5XG4gICAgfVxuICAgIHRoaXMubmV3cmVjZWlwdC5wYXRjaFZhbHVlKHtyZWNlaXB0ZGF0ZSA6IHJlY2VpcHRkYXRlLnllYXIrXCItXCIrcmVjZWlwdGRhdGUubW9udGgrXCItXCIrZGF0ZX0pO1xuICAgIGNvbnNvbGUubG9nKEpTT04uc3RyaW5naWZ5KHRoaXMubmV3cmVjZWlwdC52YWx1ZSkpXG4gICAgdGhpcy5yZWNlaXB0U2VydmljZS5jcmVhdGVSZWNlaXB0KHRoaXMubmV3cmVjZWlwdC52YWx1ZSlcbiAgICAgIC5zdWJzY3JpYmUocmVzID0+IHtcbiAgICAgICAgY29uc29sZS5sb2cocmVzKTtcbiAgICAgIH0sXG4gICAgICAgIGVycm1lc3MgPT4ge1xuICAgICAgICAgIGNvbnNvbGUubG9nKGVycm1lc3MpXG4gICAgICB9KTtcbiAgICAgIHRoaXMucm91dGVyLm5hdmlnYXRlKFsnY2FzaGZsb3cnXSlcbiAgfVxuXG4gIG51bWJlcldpdGhDb21tYXMoeCkge1xuICAgIHZhciBwYXJ0cyA9IHgudG9TdHJpbmcoKS5zcGxpdChcIi5cIik7XG4gICAgcGFydHNbMF0gPSBwYXJ0c1swXS5yZXBsYWNlKC9cXEIoPz0oXFxkezN9KSsoPyFcXGQpKS9nLCBcIixcIik7XG4gICAgcmV0dXJuIHBhcnRzLmpvaW4oXCIuXCIpO1xufVxuICB9XG4iXX0=